<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Set-Your-Password</title>
    <link rel="stylesheet" href="set-password.css" />
    <script src="https://kit.fontawesome.com/64d58efce2.js" crossorigin="anonymous"></script>
</head>

<body>
    <div class="container">
        <h2>Set Your Password üîê</h2>
        <form id="setPasswordForm" action="account-created.html">
            <div class="input-group">
                <input type="password" placeholder="New Password" id="newPassword" required />
                <span class="toggle-password" onclick="togglePassword('newPassword', this)">
                    <i class="fas fa-eye"></i>
                </span>
            </div>

            <div class="input-group">
                <input type="password" placeholder="Confirm Password" id="confirmPassword" required />
                <span class="toggle-password" onclick="togglePassword('confirmPassword', this)">
                    <i class="fas fa-eye"></i>
                </span>
            </div>

            <div id="error-message"></div>

            <button type="submit">Continue</button>
        </form>
    </div>

    <script>
        function togglePassword(id, el) {
                const input = document.getElementById(id);
                const icon = el.querySelector("i");
                if (input.type === "password") {
                    input.type = "text";
                    icon.classList.remove("fa-eye");
                    icon.classList.add("fa-eye-slash");
                } else {
                    input.type = "password";
                    icon.classList.remove("fa-eye-slash");
                    icon.classList.add("fa-eye");
                }
            }

            document.getElementById("setPasswordForm").addEventListener("submit", function (e) {
                e.preventDefault();

                const password = document.getElementById("newPassword").value;
                const confirmPassword = document.getElementById("confirmPassword").value;
                const error = document.getElementById("error-message");

                const validPassword = password.length >= 6 && /[a-zA-Z]/.test(password);

                if (!validPassword) {
                    error.textContent = "Password must be at least 6 characters and include a letter.";
                    return;
                }

                if (password !== confirmPassword) {
                    error.textContent = "Passwords do not match.";
                    return;
                }

                error.textContent = "";

                // ‚úÖ Simulate success
                alert("‚úÖ Password set successfully!");

                // ‚úÖ Clear localStorage
                localStorage.removeItem("signup_email");
                localStorage.removeItem("signup_username");

                // ‚úÖ Redirect
                window.location.href = "account-created.html";
            });

            // üö´ Prevent access if no email or username found
            window.addEventListener("DOMContentLoaded", () => {
                if (!localStorage.getItem("signup_email") || !localStorage.getItem("signup_username")) {
                    window.location.href = "auth.html#sign-up";
                }
            });
    </script>
</body>

</html>